{"ast":null,"code":"var _jsxFileName = \"/opt/lampp/htdocs/NodeJs/gereja/gereja-fe/src/components/ImportSheet.js\";\nimport React from 'react';\nimport * as XLSX from 'xlsx';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ImportSheet = () => {\n  const readExcel = (file, lingkungan_id) => {\n    const promise = new Promise((resolve, reject) => {\n      const fileReader = new FileReader();\n      fileReader.readAsArrayBuffer(file);\n\n      fileReader.onload = e => {\n        const bufferArray = e.target.result;\n        const workBook = XLSX.read(bufferArray, {\n          type: 'buffer'\n        });\n        const workBook2 = XLSX.read(bufferArray, {\n          type: 'buffer'\n        });\n        const workSheetName = workBook.SheetNames[1];\n        const workSheetName2 = workBook2.SheetNames[2];\n        const workSheet = workBook.Sheets[workSheetName];\n        const workSheet2 = workBook.Sheets[workSheetName2];\n        const kk_datas = XLSX.utils.sheet_to_json(workSheet);\n        const anggota_datas = XLSX.utils.sheet_to_json(workSheet2);\n        const datas = Array;\n        datas['kk'] = kk_datas;\n        datas['anggota'] = anggota_datas;\n        resolve(datas);\n      };\n    });\n    const url = 'http://localhost:1337/';\n    var currentdate = new Date();\n    var datetime = \"Last Sync: \" + currentdate.getDate() + \"/\" + (currentdate.getMonth() + 1) + \"/\" + currentdate.getFullYear() + \" @ \" + currentdate.getHours() + \":\" + currentdate.getMinutes() + \":\" + currentdate.getSeconds();\n    const log_data = {\n      file_name: datetime\n    };\n    promise.then(datas => {\n      axios.post(url + \"import-logs\", log_data).then(import_log_response => {\n        var import_log_id = import_log_response.data.id;\n        datas['kk'].forEach(data => {\n          console.log(data['Nama KK'] + \" | \" + data['KBG']);\n          axios.get(url + 'groups?on_sheet_id=' + data['KBG'] + '&parent.id=' + lingkungan_id).then(kbg_resp => {\n            // Post KK\n            var kbg_id = kbg_resp.data[0].id;\n            var currentdate = new Date();\n            var kbg_code = data['KBG'].split(\"-\")[1].toString();\n            var new_kbg_code;\n\n            if (kbg_code.length == 1) {\n              new_kbg_code = \"00\" + kbg_code;\n            } else if (kbg_code.length == 2) {\n              new_kbg_code = \"0\" + kbg_code;\n            } else if (kbg_code.length == 3) {\n              new_kbg_code = kbg_code;\n            }\n\n            const restructure_data = {\n              on_sheet_no_kk: String(data['No KK']),\n              nama: data['Nama KK'],\n              nama_panggilan: data['Nama Panggilan'],\n              alamat_1: data['Alamat1'],\n              alamat_2: data['Alamat2'],\n              kode_pos: data['Kode Pos'],\n              telepon: data['Telp Rumah'],\n              group: kbg_id,\n              import_log: import_log_id,\n              // published_at: null,\n              uid: kbg_resp.data[0].parent.uid + \"-\" + new_kbg_code + \"-\" + data['No KK']\n            }; // console.log(restructure_data);\n\n            axios.post(url + \"keluargas\", restructure_data).then(keluargas_resp => {\n              console.log(keluargas_resp);\n            }).catch(function (error) {\n              if (error.response) {\n                // Request made and server responded\n                console.log(error.response.data);\n                console.log(error.response.status);\n                console.log(error.response.headers);\n              } else if (error.request) {\n                // The request was made but no response was received\n                console.log(error.request);\n              } else {\n                // Something happened in setting up the request that triggered an Error\n                console.log('Error', error.message);\n              }\n            }); // End Post KK\n          });\n        }); // Post Anggota\n\n        datas['anggota'].forEach(dataanggota => {\n          // console.log(dataanggota['No KK']);\n          // Get KK\n          axios.get(url + \"keluargas?on_sheet_no_kk=\" + dataanggota['No KK'] + '&group.parent=' + lingkungan_id).then(kk_response => {\n            if (kk_response.data[0].id !== undefined) {\n              console.log(kk_response.data[0]);\n              var currentdate = new Date();\n              const restructure_data_anggota = {\n                family: kk_response.data[0].id,\n                nama: dataanggota['Nama Warga'],\n                nama_panggilan: dataanggota['Panggilan'],\n                relasi_family: dataanggota['Relasi KK'],\n                relasi_family: dataanggota['Relasi KK'],\n                gender: dataanggota['Jenis Kelamin'] == \"Laki-laki\" ? \"M\" : \"F\",\n                import_log: import_log_id,\n                // published_at: null,\n                uid: kk_response.data[0].uid + \"-\" + dataanggota['No Warga']\n              }; // Post Anggota KK \n\n              axios.post(url + \"family-members\", restructure_data_anggota).then(keluargas_resp => {\n                console.log(keluargas_resp);\n              }).catch(function (error) {\n                if (error.response) {\n                  // Request made and server responded\n                  console.log(error.response.data);\n                  console.log(error.response.status);\n                  console.log(error.response.headers);\n                } else if (error.request) {\n                  // The request was made but no response was received\n                  console.log(error.request);\n                } else {\n                  // Something happened in setting up the request that triggered an Error\n                  console.log('Error', error.message);\n                }\n              });\n            }\n          });\n        }); // End Post Anggota\n      });\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    class: \"flex w-full h-screen items-center justify-center bg-grey-lighter\",\n    children: /*#__PURE__*/_jsxDEV(\"label\", {\n      class: \"w-64 flex flex-col items-center px-4 py-6 bg-white text-blue rounded-lg shadow-lg tracking-wide uppercase border border-blue cursor-pointer hover:bg-blue hover:text-white\",\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        class: \"w-8 h-8\",\n        fill: \"currentColor\",\n        xmlns: \"http://www.w3.org/2000/svg\",\n        viewBox: \"0 0 20 20\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          d: \"M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        class: \"mt-2 text-base leading-normal\",\n        children: \"Select a file\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        class: \"hidden\",\n        onChange: e => {\n          const file = e.target.files[0];\n          const lingkungan_id = document.getElementById('select_lingkungan').value;\n          readExcel(file, lingkungan_id);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 161,\n    columnNumber: 9\n  }, this);\n};\n\n_c = ImportSheet;\nexport default ImportSheet;\n\nvar _c;\n\n$RefreshReg$(_c, \"ImportSheet\");","map":{"version":3,"sources":["/opt/lampp/htdocs/NodeJs/gereja/gereja-fe/src/components/ImportSheet.js"],"names":["React","XLSX","axios","ImportSheet","readExcel","file","lingkungan_id","promise","Promise","resolve","reject","fileReader","FileReader","readAsArrayBuffer","onload","e","bufferArray","target","result","workBook","read","type","workBook2","workSheetName","SheetNames","workSheetName2","workSheet","Sheets","workSheet2","kk_datas","utils","sheet_to_json","anggota_datas","datas","Array","url","currentdate","Date","datetime","getDate","getMonth","getFullYear","getHours","getMinutes","getSeconds","log_data","file_name","then","post","import_log_response","import_log_id","data","id","forEach","console","log","get","kbg_resp","kbg_id","kbg_code","split","toString","new_kbg_code","length","restructure_data","on_sheet_no_kk","String","nama","nama_panggilan","alamat_1","alamat_2","kode_pos","telepon","group","import_log","uid","parent","keluargas_resp","catch","error","response","status","headers","request","message","dataanggota","kk_response","undefined","restructure_data_anggota","family","relasi_family","gender","files","document","getElementById","value"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as XLSX from 'xlsx';\nimport axios from 'axios';\n\nconst ImportSheet =  () => {\n\n    const readExcel = (file, lingkungan_id) => {\n        const promise = new Promise((resolve, reject)=>{\n            const fileReader = new FileReader();\n            fileReader.readAsArrayBuffer(file);\n\n            fileReader.onload = (e)=>{\n                const bufferArray = e.target.result;\n\n                const workBook = XLSX.read(bufferArray, {type:'buffer'});\n                const workBook2 = XLSX.read(bufferArray, {type:'buffer'});\n                const workSheetName = workBook.SheetNames[1];\n                const workSheetName2 = workBook2.SheetNames[2];\n                const workSheet = workBook.Sheets[workSheetName];\n                const workSheet2 = workBook.Sheets[workSheetName2];\n\n                const kk_datas = XLSX.utils.sheet_to_json(workSheet);\n                const anggota_datas = XLSX.utils.sheet_to_json(workSheet2);\n                const datas = Array;\n                datas['kk'] = kk_datas;\n                datas['anggota'] = anggota_datas;\n                resolve(datas);\n            }\n                \n        });\n\n        const url = 'http://localhost:1337/';\n        var currentdate = new Date();\n        var datetime = \"Last Sync: \" + currentdate.getDate() + \"/\"+(currentdate.getMonth()+1) \n        + \"/\" + currentdate.getFullYear() + \" @ \" \n        + currentdate.getHours() + \":\" \n        + currentdate.getMinutes() + \":\" + currentdate.getSeconds();\n\n        const log_data = {\n            file_name: datetime\n        }\n        \n        promise.then((datas)=>{\n\n            axios.post(url+\"import-logs\", log_data).then(import_log_response => {\n                var import_log_id = import_log_response.data.id \n                datas['kk'].forEach(data => {\n                    console.log(data['Nama KK']+\" | \"+data['KBG']);\n                    axios.get(url+'groups?on_sheet_id='+data['KBG']+'&parent.id='+lingkungan_id).then(kbg_resp => {\n                        // Post KK\n                        var kbg_id = kbg_resp.data[0].id;\n                        var currentdate = new Date();\n\n                        var kbg_code = data['KBG'].split(\"-\")[1].toString();\n                        var new_kbg_code;\n                        if(kbg_code.length == 1){\n                            new_kbg_code = \"00\"+kbg_code;\n                        }else if(kbg_code.length == 2){\n                            new_kbg_code = \"0\"+kbg_code;\n                        }else if(kbg_code.length == 3){\n                            new_kbg_code = kbg_code;\n                        }\n\n                        const restructure_data = {\n                            on_sheet_no_kk: String(data['No KK']),\n                            nama: data['Nama KK'],\n                            nama_panggilan: data['Nama Panggilan'],\n                            alamat_1: data['Alamat1'],\n                            alamat_2: data['Alamat2'],\n                            kode_pos: data['Kode Pos'],\n                            telepon: data['Telp Rumah'],\n                            group: kbg_id,\n                            import_log: import_log_id,\n                            // published_at: null,\n                            uid: kbg_resp.data[0].parent.uid+\"-\"+new_kbg_code+\"-\"+data['No KK']\n                        }\n                        // console.log(restructure_data);\n\n                        axios.post(url+\"keluargas\", restructure_data)\n                        .then(keluargas_resp => {\n                            console.log(keluargas_resp);\n                        })\n                        .catch(function (error) {\n                            if (error.response) {\n                                // Request made and server responded\n                                console.log(error.response.data);\n                                console.log(error.response.status);\n                                console.log(error.response.headers);\n                            } else if (error.request) {\n                              // The request was made but no response was received\n                                console.log(error.request);\n                            } else {\n                              // Something happened in setting up the request that triggered an Error\n                                console.log('Error', error.message);\n                            }\n                        });\n                        // End Post KK\n\n                        \n\n                    });\n                });\n\n                // Post Anggota\n                datas['anggota'].forEach(dataanggota => {\n                    // console.log(dataanggota['No KK']);\n                    // Get KK\n                    axios.get(url+\"keluargas?on_sheet_no_kk=\"+dataanggota['No KK']+'&group.parent='+lingkungan_id).then(kk_response => {\n                        \n                        if(kk_response.data[0].id !== undefined){\n                            console.log(kk_response.data[0])\n\n                            var currentdate = new Date();\n                            const restructure_data_anggota = {\n                                family:kk_response.data[0].id,\n                                nama:dataanggota['Nama Warga'],\n                                nama_panggilan:dataanggota['Panggilan'],\n                                relasi_family:dataanggota['Relasi KK'],\n                                relasi_family:dataanggota['Relasi KK'],\n                                gender:((dataanggota['Jenis Kelamin'] == \"Laki-laki\") ? \"M\" : \"F\"),\n                                import_log: import_log_id,\n                                // published_at: null,\n                                uid: kk_response.data[0].uid+\"-\"+dataanggota['No Warga'],\n                            }\n                            // Post Anggota KK \n                            axios.post(url+\"family-members\", restructure_data_anggota)\n                            .then(keluargas_resp => {\n                                console.log(keluargas_resp);\n                            })\n                            .catch(function (error) {\n                                if (error.response) {\n                                    // Request made and server responded\n                                    console.log(error.response.data);\n                                    console.log(error.response.status);\n                                    console.log(error.response.headers);\n                                } else if (error.request) {\n                                  // The request was made but no response was received\n                                    console.log(error.request);\n                                } else {\n                                  // Something happened in setting up the request that triggered an Error\n                                    console.log('Error', error.message);\n                                }\n                            });\n                        }\n                        \n                    });\n                    \n                });\n                // End Post Anggota\n                \n                \n            })\n\n            \n            \n        })\n        \n    }\n\n    return(\n        <div class=\"flex w-full h-screen items-center justify-center bg-grey-lighter\">\n            <label class=\"w-64 flex flex-col items-center px-4 py-6 bg-white text-blue rounded-lg shadow-lg tracking-wide uppercase border border-blue cursor-pointer hover:bg-blue hover:text-white\">\n                <svg class=\"w-8 h-8\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\">\n                    <path d=\"M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z\" />\n                </svg>\n                <span class=\"mt-2 text-base leading-normal\">Select a file</span>\n                <input type='file' class=\"hidden\" onChange={(e)=>{\n                    const file = e.target.files[0];\n                    const lingkungan_id = document.getElementById('select_lingkungan').value;\n                    readExcel(file, lingkungan_id);\n                }} />\n            </label>\n        </div>\n    )\n    \n}\n    \nexport default ImportSheet\n    \n"]},"metadata":{},"sourceType":"module"}