{"ast":null,"code":"var _jsxFileName = \"/opt/lampp/htdocs/NodeJs/gereja/gereja-fe/src/components/ImportSheet.js\";\nimport React from 'react';\nimport * as XLSX from 'xlsx';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ImportSheet = () => {\n  const readExcel = (file, lingkungan) => {\n    alert(lingkungan); // const promise = new Promise((resolve, reject)=>{\n    //     const fileReader = new FileReader();\n    //     fileReader.readAsArrayBuffer(file);\n    //     fileReader.onload = (e)=>{\n    //         const bufferArray = e.target.result;\n    //         const workBook = XLSX.read(bufferArray, {type:'buffer'});\n    //         const workSheetName = workBook.SheetNames[1];\n    //         const workSheet = workBook.Sheets[workSheetName];\n    //         const data = XLSX.utils.sheet_to_json(workSheet);\n    //         resolve(data);\n    //     }\n    // });\n    // const url = 'http://localhost:1337/';\n    // var currentdate = new Date();\n    // var datetime = \"Last Sync: \" + currentdate.getDate() + \"/\"+(currentdate.getMonth()+1) \n    // + \"/\" + currentdate.getFullYear() + \" @ \" \n    // + currentdate.getHours() + \":\" \n    // + currentdate.getMinutes() + \":\" + currentdate.getSeconds();\n    // const log_data = {\n    //     file_name: datetime\n    // }\n    // promise.then((datas)=>{\n    //     axios.post(url+\"import-logs\", log_data).then(import_log_response => {\n    //         var import_log_id = import_log_response.data.id \n    //         datas.forEach(data => {\n    //             axios.get(url+'groups?on_sheet_id='+data['KBG']).then(kbg_resp => {\n    //                 var kbg_id = kbg_resp.data.id;\n    //                 const restructure_data = {\n    //                     on_sheet_no_kk: data['No KK'],\n    //                     nama: data['Nama KK'],\n    //                     nama_panggilan: data['Nama Panggilan'],\n    //                     alamat_1: data['Alamat1'],\n    //                     alamat_2: data['Alamat2'],\n    //                     kode_pos: data['Kode Pos'],\n    //                     telepon: data['Telp Rumah'],\n    //                     group: kbg_id,\n    //                     impor_log: import_log_id\n    //                 }\n    //                 axios.post(url+\"keluargas\", restructure_data).then(keluargas_resp => {\n    //                     console.log(keluargas_resp);\n    //                 })\n    //             });\n    //         });\n    //     })\n    //     datas.forEach(data => {\n    //     });\n    // })\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    class: \"flex w-full h-screen items-center justify-center bg-grey-lighter\",\n    children: /*#__PURE__*/_jsxDEV(\"label\", {\n      class: \"w-64 flex flex-col items-center px-4 py-6 bg-white text-blue rounded-lg shadow-lg tracking-wide uppercase border border-blue cursor-pointer hover:bg-blue hover:text-white\",\n      children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n        class: \"w-8 h-8\",\n        fill: \"currentColor\",\n        xmlns: \"http://www.w3.org/2000/svg\",\n        viewBox: \"0 0 20 20\",\n        children: /*#__PURE__*/_jsxDEV(\"path\", {\n          d: \"M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        class: \"mt-2 text-base leading-normal\",\n        children: \"Select a file\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        class: \"hidden\",\n        onChange: e => {\n          const file = e.target.files[0];\n          const lingkungan_id = document.getElementById('select_lingkungan').value;\n          readExcel(file, lingkungan_id);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 9\n  }, this);\n};\n\n_c = ImportSheet;\nexport default ImportSheet;\n\nvar _c;\n\n$RefreshReg$(_c, \"ImportSheet\");","map":{"version":3,"sources":["/opt/lampp/htdocs/NodeJs/gereja/gereja-fe/src/components/ImportSheet.js"],"names":["React","XLSX","axios","ImportSheet","readExcel","file","lingkungan","alert","e","target","files","lingkungan_id","document","getElementById","value"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,KAAKC,IAAZ,MAAsB,MAAtB;AACA,OAAOC,KAAP,MAAkB,OAAlB;;;AAEA,MAAMC,WAAW,GAAI,MAAM;AAEvB,QAAMC,SAAS,GAAG,CAACC,IAAD,EAAOC,UAAP,KAAsB;AACpCC,IAAAA,KAAK,CAACD,UAAD,CAAL,CADoC,CAEpC;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AAEA;AAEH,GA9DD;;AAgEA,sBACI;AAAK,IAAA,KAAK,EAAC,kEAAX;AAAA,2BACI;AAAO,MAAA,KAAK,EAAC,4KAAb;AAAA,8BACI;AAAK,QAAA,KAAK,EAAC,SAAX;AAAqB,QAAA,IAAI,EAAC,cAA1B;AAAyC,QAAA,KAAK,EAAC,4BAA/C;AAA4E,QAAA,OAAO,EAAC,WAApF;AAAA,+BACI;AAAM,UAAA,CAAC,EAAC;AAAR;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cADJ,eAII;AAAM,QAAA,KAAK,EAAC,+BAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAJJ,eAKI;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,KAAK,EAAC,QAAzB;AAAkC,QAAA,QAAQ,EAAGE,CAAD,IAAK;AAC7C,gBAAMH,IAAI,GAAGG,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAb;AACA,gBAAMC,aAAa,GAAGC,QAAQ,CAACC,cAAT,CAAwB,mBAAxB,EAA6CC,KAAnE;AACAV,UAAAA,SAAS,CAACC,IAAD,EAAOM,aAAP,CAAT;AACH;AAJD;AAAA;AAAA;AAAA;AAAA,cALJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,UADJ;AAgBH,CAlFD;;KAAMR,W;AAoFN,eAAeA,WAAf","sourcesContent":["import React from 'react';\nimport * as XLSX from 'xlsx';\nimport axios from 'axios';\n\nconst ImportSheet =  () => {\n\n    const readExcel = (file, lingkungan) => {\n        alert(lingkungan)\n        // const promise = new Promise((resolve, reject)=>{\n        //     const fileReader = new FileReader();\n        //     fileReader.readAsArrayBuffer(file);\n\n        //     fileReader.onload = (e)=>{\n        //         const bufferArray = e.target.result;\n\n        //         const workBook = XLSX.read(bufferArray, {type:'buffer'});\n        //         const workSheetName = workBook.SheetNames[1];\n        //         const workSheet = workBook.Sheets[workSheetName];\n\n        //         const data = XLSX.utils.sheet_to_json(workSheet);\n        //         resolve(data);\n        //     }\n                \n        // });\n\n        // const url = 'http://localhost:1337/';\n        // var currentdate = new Date();\n        // var datetime = \"Last Sync: \" + currentdate.getDate() + \"/\"+(currentdate.getMonth()+1) \n        // + \"/\" + currentdate.getFullYear() + \" @ \" \n        // + currentdate.getHours() + \":\" \n        // + currentdate.getMinutes() + \":\" + currentdate.getSeconds();\n\n        // const log_data = {\n        //     file_name: datetime\n        // }\n        \n        // promise.then((datas)=>{\n        //     axios.post(url+\"import-logs\", log_data).then(import_log_response => {\n        //         var import_log_id = import_log_response.data.id \n        //         datas.forEach(data => {\n        //             axios.get(url+'groups?on_sheet_id='+data['KBG']).then(kbg_resp => {\n        //                 var kbg_id = kbg_resp.data.id;\n        //                 const restructure_data = {\n        //                     on_sheet_no_kk: data['No KK'],\n        //                     nama: data['Nama KK'],\n        //                     nama_panggilan: data['Nama Panggilan'],\n        //                     alamat_1: data['Alamat1'],\n        //                     alamat_2: data['Alamat2'],\n        //                     kode_pos: data['Kode Pos'],\n        //                     telepon: data['Telp Rumah'],\n        //                     group: kbg_id,\n        //                     impor_log: import_log_id\n        //                 }\n\n        //                 axios.post(url+\"keluargas\", restructure_data).then(keluargas_resp => {\n        //                     console.log(keluargas_resp);\n        //                 })\n        //             });\n        //         });\n        //     })\n\n        //     datas.forEach(data => {\n                \n                \n        //     });\n            \n        // })\n        \n    }\n\n    return(\n        <div class=\"flex w-full h-screen items-center justify-center bg-grey-lighter\">\n            <label class=\"w-64 flex flex-col items-center px-4 py-6 bg-white text-blue rounded-lg shadow-lg tracking-wide uppercase border border-blue cursor-pointer hover:bg-blue hover:text-white\">\n                <svg class=\"w-8 h-8\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\">\n                    <path d=\"M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z\" />\n                </svg>\n                <span class=\"mt-2 text-base leading-normal\">Select a file</span>\n                <input type='file' class=\"hidden\" onChange={(e)=>{\n                    const file = e.target.files[0];\n                    const lingkungan_id = document.getElementById('select_lingkungan').value;\n                    readExcel(file, lingkungan_id);\n                }} />\n            </label>\n        </div>\n    )\n    \n}\n    \nexport default ImportSheet\n    \n"]},"metadata":{},"sourceType":"module"}